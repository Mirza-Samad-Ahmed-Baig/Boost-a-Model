#!/usr/bin/env python3
"""
High-performance testing without memory limitations (GPU with >20GB VRAM required)
"""

from lonely_vit_vs import ViTVisualServoing
import sys
import torch
import argparse
import os

def test_vit_features(device=None):
    # Set device via environment variable if specified
    if device:
        os.environ['CUDA_VISIBLE_DEVICES'] = device.replace('cuda:', '')
        print(f"🎯 Forcing GPU device: {device}")
    
    print("🧪 Test ViT Visual Servoing System")
    print("========================================")
    print("Sistema esclusivamente basato su Vision Transformer")
    print(r"""   
          =============================================== D0N4LD TRVMP ===============================================
                                                                                                                                                                                                   
            ░░░▒▒▓▓██▓▓▓▒▒░░          ░░░░  ░░░  ░░░░░ ░░░   ░░  ░  ░░   ░░░░░░░░░ ░░░░░░ ░ ░▒                   ░           ░   ░    ░   ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ 
  ░░▒▒▒▓▓▓▓▓▓▒▒▒░░           ░░░░ ░░░░░ ░░░░   ░░░░░░░░░░░ ░░  ░░  ░  ░░ ░░░  ░░░░░      ░▒░      ▓████▓                  ░         ░ ░   ░░░ ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ 
 ▓▓▒▒░░                ░░░░░░░░░░░░░░░░░░░ ░░░  ░░  ░   ░░    ░░░  ░░░ ░░ ░  ░░            ░░███████ ░                                    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ ░░░░░ 
                ░    ░ ░░   ░  ░░░ ░░ ░  ░     ░░░░░░░░░░  ░░░░ ░░  ░ ░             ▓██▒▒████████████████████▓       ░  ░    ░ ░     ░ ░  ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ 
                     ░ ░░  ░   ░░░  ░ ░░░░░░░░░░░   ░░░░░░░ ░░░ ░░           ▓█▓████████████████████████████████▒                 ░       ░░░ ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ 
          ░      ░     ░░░░░░░░░░░ ░  ░       ░░░░░░  ░░░        ░░░  ░    ░█████████████████████████████████████              ░     ░ ░  ░░░░░░░░░░░░░░  ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ 
  ░     ░  ░░ ░       ░░░ ░░░░░░░░ ░  ░ ░ ░░░░        ░ ░░░░░░ ░░       ░████████████████▓██▓█████████████████████▓           ░  ░        ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ ░░░░░░░░░░░░░░░░░░ 
     ░        ░     ░  ░░    ░░░░░░░ ░░░░░░    ░           ░░░ ░░       ▓█████▓██▓██████████████████████████████████    ░░      ░         ░░░░░░░░░░░░░░░░ ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ 
            ░░      ░  ░░ ░ ░░░░ ░░░ ░   ░    ░░░             ░      ████████████████████████████████████████████████                     ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ 
   ░   ░            ░░ ░░ ░░░░░░░░░    ░░░            ░      ░░ ░░   ▒████████████████▓▓▓▒▓▓▓████████████████████████▒            ░      ░░░░░░░░ ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ 
     ░    ░░  ░░░░░░   ░░░░░  ░░░░░   ░░         ░  ░    ░  ░░░░      ███▓███████▒░ ░░░░░░░░░░░░░░░░▒▒▒▒▓████████████          ░      ░   ░░░ ░░░░░░░░░░░░░░░░░░░░░░░░░░░░ ░░░░░░░░░░░░░░░░ 
        ░       ░░░░   ░░ ░░░ ░░░   ░░    ░░░         ░    ░ ░       █████████▓░    ░░░░░░░░░░░░░░░░░░░░▒████████████                    ░▒░░░░░░░░░░░░░░░ ░░░░░ ░░░░░░░▒░░░░░░░░░░░░░░░░░░ 
  ░   ░    ░       ░ ░ ░░ ░░░░░░░░░░░      ░░░░░░░                   ▒██████▒░   ░░░░░░░░░░░░░░░░░░░░░░▒▒▓▓██████████    ░      ░    ░    ░░░░░   ░░ ░░░░░░░▒▒░░░░░░░░░░░░░░░░░░░░░░░░░ ░░░ 
           ░  ░░       ░░  ░░░   ░░░   ░░            ░ ░ ░    ░  ░    █████░ ░   ░░░░░░░░░░░░░░░░░░▒▒░░░░░░░▒▒▒▓▓▓███░ ░    ░          ░  ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ ░░░░░░░░░░ 
 ░     ░             ░ ░░ ░  ░░   ░   ░  ░░       ░░                 ░▒████  ░░░░░░░░░░░░░░░░░░▒░░░░▒░░░░▒▒▒░▒▒▒▒▒▒▓█▒          ░    ░    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ 
    ░  ░ ░░            ░░ ░ ░░░░░░ ░░░░░░ ░░░░░░░ ░░ ░      ░   ░░     ▓██░ ░░░░░░░░░░░░░░░░░░░░░▒▒▒▒▒▒▒░▒▒▒▒▒▒▒▒▒▒▒▓   ░              ░  ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ 
     ░      ░ ░░   ░   ░░ ░░░░░ ░░░░ ░░░  ░ ░░ ░░ ░  ░ ░░ ░            ▒█░ ░░░░░░░░░░░░░░░░░░░░░░ ░░░▒▒▒▒▒▒▒▒▒▒▒▒▒▒▓▓      ░ ░            ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ ░░░░░░░░░ 
   ░    ░  ░     ░     ░░ ░░░░ ░░░░       ░░░  ░     ░       ░      ░░ ░▒ ░░░░░      ░ ░ ░    ░▒▓▓▓▓▒▒░░▒▒▒▒▒▒▒▒▒▒▒▓▓                ░░░  ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ 
                    ░░ ░░ ░░░░ ░░░  ░░░░     ░     ░░ ░▒▒░   ░   ░     ░░░░░  ░▒▒░░░░░░░░▒▒▓██▓░   ░░░░░▒▒░▒▒▒▒▒▒▒▒▓█░     ░              ▒░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ 
          ░   ░        ░░ ░░░░  ░              ░ ░ ░░▒▓▒▓░     ░ ░     ░░░░▒▓▓▒▒█▓▓▓▒▒░░░▒▒▒░    ░░░░░▒▒▒▒▒▒▒▒▒▒▒▒▓▓▒▒███▒    ░      ░░   ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ 
   ░ ░░░   ░░   ░░  ░  ░░ ░░░░░░  ░░░░ ░ ░░░  ░  ░░░▒▒▓▒▓▒▒▒        ░   ░░░░       ░░░░▒░░▒▒▒██████████▓▒▒░░▒▒▒▒▒▓▓░░▒░▒█▓        ░       ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ 
       ░ ░░░           ░░ ░   ░    ░░    ░     ░░  ░▒▓▒▒▓▓▒█  ░░░░░   ░ ░░░░░▓██████▓▒▒  ░░▒▒▒░   ░░░░░░░░░▒▒▒▒▒▒▓▓▓█▒░░▓▓                ░░░░░░░░░░░░░░░░░░░░  ░░░░░░░░░░░░░░░░░░░░░░░░░░░ 
   ░          ░  ░   ░ ░░ ░░░░░   ░░░  ░░░  ░ ░░░▒▒░▒▓░▒▓▒▒█        ░   ░░░▒██░   ░▒▒▒░  ░▒░░░▒▒▒▒░░░░░░░░░░▒▒▒▒▒▓▓▓▓█▓░▓▓       ░▒▒▒▓▓██▓░░░░░░░░░░░░░░░░░░░░░░░░ ░░░░░░░░░░░░░░░░░░░░░░░░ 
         ░░░░          ░░ ░   ░░░░    ░     ░  ░░▒▒░▒▒▒▒▓░▒▒       ░   ░▓░   ░▒▒▓▓▓▒ ░░ ░░▒▒░░  ░░░░░░░░░▒▒▒▒▒▒▒▒▓▒░░ ▒░▓▓▓█████▓▓▒░░     ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ 
    ░              ░  ░░░░░░░░░░░░░░░  ░ ░ ░░░░▒▒▓▒▒▓▒▒▓░░▓░            ▒░░░░  ░     ░  ░░▒▒░░ ░░░░░░░░░░░▒▒▒▒▒▒▒▓▒█▒░▒▓▓                ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ ░░ 
       ░               ░░      ░░ ░ ░░░░       ░▒▒░▒▒░░▓▒▓█  ░ ░░ ░   ░░░░░░░░░░   ░░░  ░░▒▒▒▓▒░ ░░░░░░░▒▒▒▒▒▒▒▒▒▒▓▒▒▒▒▓             ░ ░  ░░░░░░░░░░░░░░░ ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ 
   ░     ░░░ ░  ░      ░       ░        ░ ░ ░░▒▓▓▒░▒▒░▒▒░▒▒              ░░░░░░░ ░░▒░        ░█▓░░░░░░░▒▒▒▒▒▒▒▒▒▒▓▓▒▒▒▓        ░ ░   ░    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ 
           ░      ░░░░░░░░░░░░ ░░░░░░░░░ ░░   ░▒▒▒▓▓▒▒█░░▒▒     ░░░░▒▒▒▓▓▓▒░░░░░░░░▒▒▓█▓▓█████▒░▒░░░░░░▒▒▒▒▒▒▒▒▒▒▒▓█▒     ░  ░     ░      ░░░░░░░░░░░░░░░░░░░ ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ 
    ░░  ░         ░ ░ ░░░ ░ ░░ ░ ░░░░    ░  ░▒▓▓░▒▒░▒▒▒░▒▓▒▓▓▓▓▓▓▒▒▒░░░   ░▒░░░░░░▒▒▒▒▓▒▓▓░▒▒▒░░░░░░░▒▒▒▒▒▒▒▒▒▒▓▒▒▓▒    ░      ░   ░ ░░   ░░░ ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ ░ 
           ░    ░░   ░ ░░ ░            ░▒░░░▒▒▒ ░▒░▒▒▒░░▒▒                 ▒░░░░░▒▒░░         ░░░░░░░░░░▒░░▒▒▒▒▒▒▒█▒           ░         ░░░░░░░░░░░░░░░░░░░░ ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ 
        ░░                ░░▒▒▒▓▓▓▓▓▓▓▓▒░  ░░░▒▒▒▒▒▒▒░▒▒▓░  ░▒▒▒▒          ░░░░░░░░░░  ▒▒▒▓██▓░░░░░░░░░░░▒▒▒▒▓▓▓▒▒█░    ░   ░░░ ░    ░░░  ░░░ ░ ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ 
             ░░▒▒▒▓▓███▓▓▓▒▒░░░           ░░░░▒▒▓▒▒▓▒▒▒▒▓  ▓▒▒▒▒█▒          ▒░░░░░░░▒███████▓███▓▒░░░░░░▒▒▒▒▒▒▒▒▓▒█       ░░        ░     ░░              ░░░░░░░░░░░░░░░░░░░░░░░░░░░ ░░░░░ 
 ░░▒▒▓▓▓██▓▓▓▓▒▒░░                    ░ ░░░░▒▒▓▓▒▒▒▒▓▓▒░░▓▓▒▒▒▒█▒           ░░░░░░░▒█▓     ░░░░░░▒▒░░▒▒▒▒▒▒▓▓▓▓▓▒▓██░  ░                    ▒██████████▓▒     ░░░░ ░░░░░░░░░░░░░░░░░░░░░░░░ 
 ▒▒░░                  ░        ░    ░  ░░░░░▒▒▒▒▒░░   ░▒▒░░▒▒█▒             ▒▒░░░░▒░░▒▓█████▓▒▒▒▒▒▒▒▒▒▒▒▒▓▓▓▓▓▒▒▒░███  ░  ░ ░  ░       ▒████▓▓▒▓▓▓▓▓▓▓█████▒    ░░░░░░ ░░░░░░░░░░░░░░░░░░░ 
         ░░     ░ ░░░  ░             ░ ░░░░░░▒▒▒░░░░░░░░▒▒░▒▓█                ▒▒▒▒▒▒▒▒▒▒▒▒▒░░▒░▒░▒▒▒▒▒▒▒▓▓▓▒▓▓▒▒▒▓████                ▓██▓▓▓▒▒▒▒▓▓▓▓▓▓▓▓▓▓▓████░    ░░░░░░░░░░░░░░░░░░░░░░░ 
   ░░        ░ ░░░ ░░ ░░             ░░░░░░░░▒▒▒░░░░ ░▒░▒▒▒█▒    ░      ░░     ░▓▓▒▒▒░░░░ ░░░   ░░▒▒▒▒▓▓▓▒▒▒▒▒▒████████   ░  ░       ██▓▓▓▓▓▒▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓█████    ░░░░░░░░░░░░░░░░░░░░░ 
   ░   ░    ░          ░       ░ ░  ░░░░░░░░▒▒▒▒░░░░░░▒░▒▒█▒  ░   ░              ▓▓▒▒░░░░░░░░░▒░▒▒▒▓▓▓▓▒▒▒▒▒▒███████████            ▓█▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓████   ░░░░░░░░░░░░░░░░░░░░ 
              ░   ░   ░░            ░░▒▒░▒▒▒░▒▒░    ░ ░░▒█▒        ░ ░      ░     ▒▓▓▓▓▓▓▒▒▒▒▒▓▓███▓▒▒▒▒▒▒▓███████████████████     ░█▓▓▓▓▓▓█▓▓▓▓██▓▓▓▓▓▓▓▓▓▓▓▓█▓█████▓  ░░░░░░░░░░░░░░░░░░░ 
  ░░     ░           ░░░   ░      ░░  ░░░░░░░░▒░░░░░░░░▒█▓                          ░░░▒▓█████▓▓▒▒▒▒▒▒▒▓█████████████████████████▓  ▓▓▓▓▓████████████████▓████▓▓███████   ░░░░░░░░░░░░░░░░░ 
 ░░░░░ ░  ░░   ░      ░░ ░      ▒░ ░░░░░░░░░▒▒▒▒░▒▒▒▒▒██▒               ▒█████████████▓▒▒▓▒▒▒▒▒▒▓█████████████████████████████████████████▒░  ▒▒▒▒▓▒▓▓▓█████████████████▓  ░░░░░░░░░░░░ ░░░ 
                  ░   ░░      ██░  ░░░▒▒▒░░░▒▒▒░░░▒▓██▒        ░████████████████████████░▒███████▓▒████████████████████████████████████████████▓▒▒▓▓▓▓▓▓▓▓████████████████   ░░░░░░░░░░░░░░ 
  ░░░░░ ░  ░░         ░░     ██   ░░░░░▒▒▒▓█▓▓██████       ████████████████████████▓█████░▒░░░  ▒██████████████████████████████████████████████████▒▒▒▒▓▓▓▓████████████████  ░░░░░░░░░░░░░░ 
  ░░░    ░   ░░░░░ ░  ░░   ███░  ░ ░░░░░░▒▒▒░▓▒       ████████████████████████████▓███████░█ ▒███████████████████████████████████████████████████████████▓▓▓█▓█████████████▓  ░░░░░░░░░░░░░ 
           ░             ████▒   ░░░▒▒▒▒▒▒▒▒██▒  ████████████████████████████████▓██████████████████████████████████████████████████████████████████████████████████████████░ ░░░░░░░░░ ░░░ 
     ░░       ░  ░     ▒████▓░░░░░░░▒▒▒▒▒▒▓███ ████████████████████████████████████████████████████████████████████████████████████████████████████████████▒ ░██████████████▓ ░░░░░░░░░░░░░ 
 ░░      ░            ██████▒░░░░░▒▒▒▒▒▒▒▓███████████████████████████████████████████▓███████████████████████████████████████████████████████████████████████████████████████ ░░░░░░░░░░░░░ 
    ░   ░░  ░░      ▓██████▓▒░░░▒▒▒▒▒▒▒▓███████████████████████████████████████████▓████████████████████████████████████████████████████████████████████████████████████████▓ ░░░░░░░░░░░░░ 
         ░         ███▓███▓▒▒▒▒▒▒▒▒▒▒▓█████████████████████████████████████████████████▓░  ▒████████████████████████████████████████████████████████████████████████████████  ░░░░░░░░░░░░░ 
   ░      ░░░    ▓███▓████▓▒▒▒▒▒▒▒▒▓▒░░████████████████████████████████████████▓▓███████▓▒▓████████████████████████████████████████████████████████████████████▓▓██████████  ░░░░░░░░░░░░░░ 
 ░   ░         ▓███▒░████▒▒▒▒▒░░▓▓░░▓███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▒░███████   ░░░░░░░░░░░░░░░ 
   ░   ░░░   ▒████▓▒███████▒░░▓▓▒ ██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████░▒███▒     ░░░░░░░░░░░░░░░░ 
 ░░░░░░░░   █████▓ █████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████░       ░░░░░░░░░░░░░░░░░░░ 
    ░░     ████▓ ░██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████  ░░░░░░  ░░░░░░░░░░░░░░░░░ 
 ░     ░  █████▒█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████  ░░░░░░░░░░░░░░░░░░░░░░░░ 
 ░░░░░   ▓█████▓██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ ░░░░░░░░░░░░░░░░░░░░░░░░ 
 ░░░    ▒████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████  ░░░░░░░░░░░░░░ ░░░░░░░░░ 
 ░░░░   ██████████▓▒▓██████████████████████████████████████████████████████████████████████████████████████ ████████████████████████████████████████████████████   ░░░░░░░░░░░░░░░░░░░░░░░░ 
 ░░ ░  ███████▓▓▓██████████████████████████████████████████████████████████████████████████████████████████ ▒  ▒░ ░▒████████████████████████████████████████████  ░░░░░░░░░░░░░░░░░░░░░░░░░ 
  ░░  ███████▓██████████████████████████████████████████████████████████████████░░▒▒██████████████████████▓▒▒  ▒  ▒░▓███████████████████████████████████████████  ░░░░░░░░░  ░░░░░░░░░░░░░░ 
 ░░░  ██████▓████████████████████████████████████████████████████████████████████░░███████████████████████  ░░▒▒░░░░█████████████████████████████████████████████ ░░░░░░░░░░░░░░░░░░░░░░░░░ 
     ████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████  ░░░░░░░░░░░░░░░░░░░░░░░░ 
 ░░  █████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████   ░░░░░░░░░░░░░░░▒▒░▒░▒░ 
    ▒██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▒  ░░░░░░░░░░░░░░░░░░░░░ 
  ░ ▓███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▓      ░░░░░░░░░░░░░░░░ 
 ▓▓▒▓███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▓░     ░░░░░░░░░░░░ 
     ██████▓▓▓▓███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▓█████████████████████▓▓▓█████▒     ░░░░░░░░░ 
 ░░░  █████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▒▓▓▓▓▓▓██████▒    ░░░░░░ 
 ░░░    ███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▒▓▓▓▓▓▓▓▓▓▓▓████▒  ░░░░░ 
  ░░░░      ███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▒▓▓▓▓▓▓▓▓▓████████  ░░░░ 
  ░░░░░░░         ▒████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████░▒▓▓▓▓▓▓███████████  ░░░ 
 ░░░░░░░░░░░░░             ░▓███████████████████████████████████████████░░▒ ████████████████████████████████████████████████████████████████████████████████████████▓▒▓▓▓▓▓██▓▓███████░ ░░░ 
 ░░░░░░░░  ░░░░░░░░░░░░░░            ███████████████████████████████████▓ ░██████████████████████████████████████████████████████████████████████████████████████████▓▓▓▓▓█▓▓▓▓████████ ░░░ 
 ░░░░░░░░░░░  ░░░░░░░░░░░░░░░░░ ░░░ ░█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▓▓▓▓▓▓▓▓█████▓▓██ ░░░ 
 ░░░░░ ░ ░░ ░░░░░ ░░ ░░░░░░░░░░      █████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▓▓▓▓▓█████████▓██  ░░ 
 ░░░░░░░ ░░░░░░░░ ░░░▒░░░░░░░░░  ░  ░████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▒▓▓▓▓▓█████████▓██░ ░░ 
                                     █▓▓▓▓▒▓▓▓▓▓▓▓▓▓▓▓▓▓▓██████████▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓████▓▓▓█▓▓▓▓▓▓▓▓▓▓▓▓███████████████████████████████████████████████████████████░░▒▒▒▒▒▓▓▓▓▓▓▓▓▒▓██     """)
    
    
    
    # Check GPU info
    if torch.cuda.is_available():
        gpu_name = torch.cuda.get_device_name(0)
        gpu_memory = torch.cuda.get_device_properties(0).total_memory / 1024**3
        print(f"🚀 GPU: {gpu_name} ({gpu_memory:.1f}GB)")
        
        if gpu_memory > 20:  
            print("⚡ Fantasmagorical GPU detected - No memory limitations!")
        else:
            print("📊 Standard GPU detected")
    else:
        print("⚠️  CPU mode - crazy man, no GPU no powah!")
    
    try:
        # System initialization
        print("Using default parameters")
        vitvs = ViTVisualServoing()
        print("✅ Sistema ViT-VS inizializzato")
        
        # Test with real images from my desktop...really mate.
        goal_path = "dataset_small/WhatsApp Image 2025-06-23 at 16.50.48.jpeg"
        current_path = "dataset_small/WhatsApp Image 2025-06-23 at 16.50.48 (1).jpeg"
        
        print(f"\n🔍 Testing ViT Visual Servoing...")
        print(f"   Goal: {goal_path}")
        print(f"   Current: {current_path}")
        print(f"   Metodo: Vision Transformer (DINOv2)")
        
        # Test con ViT (sistema principale)
        result = vitvs.process_image_pair(
            goal_path, 
            current_path, 
            visualize=True
        )
        
        if result:
            print(f"\n✅ SUCCESS! ViT Visual Servoing funziona!")
            print(f"📊 Features rilevate: {result['num_features']}")
            print(f"🎯 Velocità calcolata:")
            velocity = result['velocity']
            print(f"   vx={velocity[0]:.4f}, vy={velocity[1]:.4f}, vz={velocity[2]:.4f}")
            print(f"   ωx={velocity[3]:.4f}, ωy={velocity[4]:.4f}, ωz={velocity[5]:.4f}")
            
            # Calcola norma velocità per valutazione
            velocity_norm = (velocity[0]**2 + velocity[1]**2 + velocity[2]**2 + 
                           velocity[3]**2 + velocity[4]**2 + velocity[5]**2)**0.5
            print(f"� Norma velocità: {velocity_norm:.4f}")
        else:
            print("\n❌ FAILED! ViT Visual Servoing non funziona")
        
    except Exception as e:
        print(f"❌ Errore durante il test: {e}")
        import traceback
        traceback.print_exc()

if __name__ == "__main__":
    parser = argparse.ArgumentParser(description='Test ViT Visual Servoing System')
    parser.add_argument('--device', type=str, default=None, 
                      help='GPU device to use (e.g., cuda:0, cuda:1, cpu)')
    parser.add_argument('--config', type=str, default='vitvs_config.yaml',
                      help='Config file path')
    
    args = parser.parse_args()
    
    # Set device if specified
    if args.device:
        print(f"🎯 Using specified device: {args.device}")
    
    test_vit_features(device=args.device)
